<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Annotate splice variants effects with resulting junctions — annotate_mut_effect • splice2neo</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Annotate splice variants effects with resulting junctions — annotate_mut_effect"><meta property="og:description" content="The mutation effects donor loss (DL), donor gain (DG), acceptor loss (AL),
and acceptor gain (AG) are annotated with respect to the provided transcripts
to build resulting splice junctions.
Donor loss (DG) and acceptor loss (AD) are only considered when overlapping
with an exon-intron junction in the provided transcripts."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">splice2neo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/TRON-Bioinformatics/splice2neo/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Annotate splice variants effects with resulting junctions</h1>
    <small class="dont-index">Source: <a href="https://github.com/TRON-Bioinformatics/splice2neo/blob/HEAD/R/annotate_mut_effect.R" class="external-link"><code>R/annotate_mut_effect.R</code></a></small>
    <div class="hidden name"><code>annotate_mut_effect.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The mutation effects donor loss (DL), donor gain (DG), acceptor loss (AL),
and acceptor gain (AG) are annotated with respect to the provided transcripts
to build resulting splice junctions.
Donor loss (DG) and acceptor loss (AD) are only considered when overlapping
with an exon-intron junction in the provided transcripts.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">annotate_mut_effect</span><span class="op">(</span></span>
<span>  <span class="va">effect_df</span>,</span>
<span>  <span class="va">transcripts</span>,</span>
<span>  <span class="va">transcripts_gr</span>,</span>
<span>  gene_mapping <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>effect_df</dt>
<dd><p>a data.frame with variant effects on splicing per row. It
should have at least the following columns:</p><ul><li><p><code>chr</code> chromosome</p></li>
<li><p><code>pos</code> absolute position of the effect</p></li>
<li><p><code>effect</code> an splicing effect class, one of <code>DL</code>, <code>DG</code>, <code>AL</code>, <code>AG</code>.
optional column:</p></li>
<li><p><code>gene_id</code> ENSEMBL gene id. Is required if <code>gene_mapping</code> is set to TRUE</p></li>
</ul></dd>


<dt>transcripts</dt>
<dd><p>a GRangesList with transcripts defined as GRanges of exons
created by <code>GenomicFeatures::exonsBy(txdb, by = c("tx"), use.names = TRUE)</code>.</p></dd>


<dt>transcripts_gr</dt>
<dd><p>a GRanges object with transcript created by
<code>GenomicFeatures::transcripts(txdb, columns = c("gene_id", "tx_id", "tx_name"))</code></p></dd>


<dt>gene_mapping</dt>
<dd><p>Indicator whether only transcripts related to the gene
provided in the <code>gene_id</code> column in <code>effect_df</code> are considered.
If <code>gene_mapping</code> is FALSE, all potentially affected  transcripts covering
the relevant genomic position are considered.
If <code>gene_mapping</code> is TRUE, potentially affected transcripts from the gene
provided in <code>effect_df</code> that cover the relevant genomic positions are considered.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data.frame with with additional rows and columns including the
splice junction in the column <code>junc_id</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spliceai_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"spliceai_output.vcf"</span>, package <span class="op">=</span> <span class="st">"splice2neo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="parse_spliceai.html">parse_spliceai</a></span><span class="op">(</span><span class="va">spliceai_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">effect_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="format_spliceai.html">format_spliceai</a></span><span class="op">(</span><span class="va">df_raw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">annotate_mut_effect</span><span class="op">(</span><span class="va">effect_df</span>, <span class="va">toy_transcripts</span>, <span class="va">toy_transcripts_gr</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: calculate coordinates of upstream and downstream exons...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: get overlapping transcripts...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: Build df ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: build pairs...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: find overlapping exons...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: calculate junction coordinates from predicted effect...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO: Evaluation of rules done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 168 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    mut_id     effect score chr   pos_rel    pos effect_index var_nr tx_chr tx_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> chr2_1523… AG      0.01 chr2       43 1.52<span style="color: #949494;">e</span>8 EIDX_1            1 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> chr2_1523… DL      0.74 chr2        3 1.52<span style="color: #949494;">e</span>8 EIDX_2            2 chr2   ENST…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 158 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 17 more variables: tx_strand &lt;chr&gt;, upstream_start &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   upstream_end &lt;int&gt;, downstream_start &lt;int&gt;, downstream_end &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   at_start &lt;lgl&gt;, at_end &lt;lgl&gt;, event_type &lt;chr&gt;, rule_left &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   rule_right &lt;chr&gt;, strand_offset &lt;dbl&gt;, coord_1 &lt;dbl&gt;, coord_2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   left &lt;dbl&gt;, right &lt;dbl&gt;, junc_id &lt;chr&gt;, tx_junc_id &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jonas Ibn-Salem, Franziska Lang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

